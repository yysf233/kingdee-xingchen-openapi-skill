---
id: "kdcloud-8662431ace8a11ef8aeda16428db4d85"
title: "委外加工单保存"
source: "金蝶云社区"
url: "https://open.jdy.com/#/files/api/detail?index=3&categrayId=&id=8662431ace8a11ef8aeda16428db4d85"
author: ""
published_at: ""
product: "金蝶云苍穹"
module: ["生产云", "委外管理", "委外加工单"]
language: "Kingscript"
version_hint: ["V2"]
keywords: []
quality: "B"
---

# 委外加工单保存

### 基本信息

-   用途说明：委外加工单保存
-   请求方式：POST
-   请求地址：https://api.kingdee.com/jdy/v2/pm/subm\_workorder

### 请求参数

#### headers参数

| 参数名称 | 参数示例 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| Content-Type | application/json | true | 固定传：application/json |
| X-Api-ClientID | 205022 | true | 应用id，[创建指引](https://open.jdy.com/#/files/api/detail?index=3&categrayId=316e1f5bd9d711ed8e36c17691e84ff5&id=a540e3dcd9d811ed8e3677dc79b66e86&noside=true) |
| X-Api-Auth-Version | 2.0 | true | 固定传:2.0 |
| X-Api-TimeStamp | 1655775240000 | true | 当前时间毫秒时间戳，有效期为5min |
| X-Api-SignHeaders | X-Api-TimeStamp,X-Api-Nonce | true | 固定传：X-Api-TimeStamp,X-Api-Nonce |
| X-Api-Nonce | 1655775240000 | true | 随机正整数 |
| X-Api-Signature | xxx | true | [参考加密规则](https://open.jdy.com/#/files/api/detail?index=3&categrayId=5403e0fd6a5811eda819b759130d6d33&id=b5c26557da9d11ed8e36f9799578d2e1&noside=true) |
| app-token | xxx | true | 产品账套级别的token，[获取指引](https://open.jdy.com/#/files/api/detail?index=3&categrayId=5403e0fd6a5811eda819b759130d6d33&id=9076d1a6da9d11ed8e36874bed64e0be&noside=true) |
| X-GW-Router-Addr | https://tf.jdy.com | true | IDC域名，获取appKey返回消息体内的domain字段 |

#### body参数

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| bill\_date | string | true | 单据日期 |
| due\_date | string | true | 结算日期 |
| material\_entity | List <MaterialEntity> | true | 商品分录 |
| settle\_supplier\_id | string | true | 结算供应商 |
| supplier\_id | string | true | 供应商 |
| attachments\_url\_list | List <AttachmentsUrl> | false | 附件地址 |
| bill\_no | string | false | 单据编码 |
| contact\_address | string | false | 供应商详细地址 |
| contact\_city\_id | string | false | 供应商发货地址-市ID |
| contact\_country\_id | string | false | 供应商发货地址-国家ID |
| contact\_district\_id | string | false | 供应商发货地址-区ID |
| contact\_linkman | string | false | 供应商发货地址-联系人 |
| contact\_phone | string | false | 供应商发货地址-供应商联系电话 |
| contact\_province\_id | string | false | 供应商发货地址-省ID |
| currency\_id | string | false | 币别 |
| custom\_field | Map <string> | false | 自定义字段[使用指南](https://open.jdy.com/#/files/api/detail?id=76567ff2a06311edaa4b3d71bf0fce53&noside=true) |
| dept\_id | string | false | 部门id |
| dispatcher\_address | string | false | 收货联系人地址-收货详细地址 |
| dispatcher\_city\_id | string | false | 收货联系人地址-市id |
| dispatcher\_country\_id | string | false | 收货联系人地址-国家id |
| dispatcher\_district\_id | string | false | 收货联系地址-区县id |
| dispatcher\_linkman | string | false | 收货联系人地址-联系人 |
| dispatcher\_phone | string | false | 收货联系人地址-收货联系电话 |
| dispatcher\_province\_id | string | false | 收货联系人地址-省id |
| emp\_id | string | false | 业务员id |
| exchange\_rate | string | false | 汇率，应大于零，币别为本币时，汇率取1,汇率小于零时，修正为1 |
| id | string | false | 单据ID，新增时不填，修改单据时必填 |
| is\_entrust\_process | boolean | false | 是否开启受托加工 默认false 开启true 源单为销售订单时，无法开启受托加工，材料无法选择开启客供件 |
| mulbill\_label | List <Mullabel> | false | 单据标签 |
| operation\_key | string | false | 操作类型，审核audit、unaudit反审核 |
| payment\_entry | List <PaymentEntry> | false | 结算账户 |
| remark | string | false | 单据备注 |
| trans\_type\_id | string | false | 业务类型id:1501普通,1502返修 |

**PaymentEntry**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| pay\_type\_id | string | true | 结算方式id |
| settle\_account\_id | string | true | 结算账户id |
| paid\_amount | number | false | 结算额度 |
| pay\_comment | string | false | 备注 |

**Mullabel**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| id | string | true | id |
| name | string | true | 名称 |
| number | string | true | 标签编码 |

**AttachmentsUrl**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| url | string | false | 附件地址 |

**MaterialEntity**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| material\_id | string | true | 商品id |
| plan\_commit\_date | string | true | 计划开工日期（格式：2019-01-01） |
| plan\_finish\_date | string | true | 计划完工日期（格式：2019-01-01） |
| qty | number | true | 数量 |
| sub\_material\_entity | List <Sub\_MaterialEntity> | true | 材料分录 |
| unit\_id | string | true | 单位id |
| act\_non\_tax\_amount | string | false | 不含税加工费 |
| all\_amount | number | false | 含税加工费 |
| aux1\_id | string | false | 辅助属性1id |
| aux2\_id | string | false | 辅助属性2id |
| aux3\_id | string | false | 辅助属性3id |
| aux4\_id | string | false | 辅助属性4id |
| aux5\_id | string | false | 辅助属性5id |
| aux\_prop\_id | string | false | 辅助属性id |
| aux\_qty | number | false | 辅助单位数量 |
| aux\_unit\_id | string | false | 辅助单位id |
| bom\_id | string | false | 商品BOM单id,如果没有值,且材料分录没有值,如果产品配置了BOM会自动带出 |
| cess | number | false | 税率 |
| comment | string | false | 行备注 |
| custom\_entity\_field | Map <string> | false | 自定义字段[使用指南](https://open.jdy.com/#/files/api/detail?id=76567ff2a06311edaa4b3d71bf0fce53&noside=true) |
| customer\_id | string | false | 客户id |
| id | string | false | 商品分录id，新增不传该字段，修改必传 |
| multi\_order\_no | string | false | 订单号 |
| price | number | false | 加工费单价 |
| pro\_license | string | false | 生产许可证 |
| pro\_place | string | false | 产地 |
| pro\_reg\_no | string | false | 注册证号 |
| sp\_id | string | false | 仓位id |
| src\_bill\_type\_id | string | false | 源单类型id |
| src\_entry\_id | string | false | 源单分录id |
| src\_inter\_id | string | false | 源单id |
| stock\_id | string | false | 仓库id |
| supp\_material\_id | string | false | 供应商商品id |
| tax\_amount | number | false | 税额 |
| tax\_price | number | false | 含税加工费单价 |

**Sub\_MaterialEntity**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| issue\_pattern | string | ture | 发料方式 D：直接领料 A：倒冲领料 B：不领料 |
| den\_qty\_scrap | string | true | 产品产量（分母） |
| num\_qty\_scrap | string | true | 材料用量（分子） |
| sub\_material\_id | string | true | 物料编码ID |
| sub\_qty | number | true | 计划投料数 |
| sub\_unit\_id | string | true | 单位(M)ID |
| bom\_user\_define1 | string | false | 物料行备注1 |
| bom\_user\_define2 | string | false | 物料行备注2 |
| bom\_user\_define3 | string | false | 物料行备注3 |
| def\_float\_qty\_loss | string | false | 默认浮动单位损耗数量 |
| fix\_loss | string | false | 固定损耗 |
| fix\_loss\_scrap | string | false | 损耗率（%） |
| id | string | false | 材料分录id，新增时不传，修改时必传 |
| is\_cust\_supitem | boolean | false | 是否客供件 默认false 开启true |
| material\_note | string | false | 物料行备注 |
| station | string | false | 工位 |
| sub\_aux1\_id | string | false | 辅助属性(M)1ID |
| sub\_aux2\_id | string | false | 辅助属性(M)2ID |
| sub\_aux3\_id | string | false | 辅助属性(M)3ID |
| sub\_aux4\_id | string | false | 辅助属性(M)4ID |
| sub\_aux5\_id | string | false | 辅助属性(M)5ID |
| sub\_aux\_prop\_id | string | false | 辅助属性(M)ID |
| sub\_aux\_qty | string | false | 辅助数量（M） |
| sub\_aux\_unit\_id | string | false | 辅助单位(M)ID |
| sub\_pro\_license | string | false | 生产许可证(M) |
| sub\_pro\_place | string | false | 产地(M) |
| sub\_pro\_reg\_no | string | false | 注册证号(M) |
| sub\_sp\_id | string | false | 仓位ID |
| sub\_stock\_id | string | false | 仓库ID |
| sub\_supp\_material\_id | string | false | 供应商商品id |

#### 请求示例

```bash
curl --location --request  post 'https://api.kingdee.com/jdy/v2/pm/subm_workorder' \
--header 'Content-Type: application/json' \
--header 'X-Api-ClientID: 205022' \
--header 'X-Api-Auth-Version: 2.0' \
--header 'X-Api-TimeStamp: 1655775240000' \
--header 'X-Api-Nonce: 1655775240000' \
--header 'X-Api-SignHeaders: X-Api-TimeStamp,X-Api-Nonce' \
--header 'X-Api-Signature: xxx' \
--header 'app-token: xxx' \
--header 'X-GW-Router-Addr: https://tf.jdy.com' \
--data-row ' { 	"attachments_url_list":[ 		{ 			"url":"http" 		} 	], 	"bill_date":"2019-0-01", 	"bill_no":"BM001", 	"contact_address":"122212", 	"contact_city_id":"1", 	"contact_country_id":"697140092908614656", 	"contact_district_id":"312", 	"contact_linkman":"联系人A", 	"contact_phone":"13825254099", 	"contact_province_id":"1011", 	"currency_id":"1", 	"custom_field":{}, 	"dept_id":"1", 	"dispatcher_address":"广东深深圳市XXXXX", 	"dispatcher_city_id":"1", 	"dispatcher_country_id":"5", 	"dispatcher_district_id":"7", 	"dispatcher_linkman":"小微", 	"dispatcher_phone":"13222445566", 	"dispatcher_province_id":"1", 	"due_date":"2019-0-01", 	"emp_id":"1", 	"exchange_rate":"1", 	"id":"001", 	"is_entrust_process":true, 	"material_entity":[ 		{ 			"act_non_tax_amount":"1", 			"all_amount":11, 			"aux1_id":"111", 			"aux2_id":"2", 			"aux3_id":"3", 			"aux4_id":"1", 			"aux5_id":"1", 			"aux_prop_id":"1", 			"aux_qty":50, 			"aux_unit_id":"1", 			"bom_id":"1", 			"cess":13, 			"comment":"行备注", 			"custom_entity_field":{}, 			"customer_id":"1", 			"id":"1", 			"material_id":"843913969650383872", 			"multi_order_no":"1", 			"plan_commit_date":"2020-01-01", 			"plan_finish_date":"2020-01-01", 			"price":1, 			"pro_license":"123", 			"pro_place":"深圳", 			"pro_reg_no":"0001", 			"qty":50, 			"sp_id":"1", 			"src_bill_type_id":"2", 			"src_entry_id":"1", 			"src_inter_id":"001", 			"stock_id":"1", 			"sub_material_entity":[ 				{ 					"bom_user_define1":"1", 					"bom_user_define2":"1", 					"bom_user_define3":"1", 					"def_float_qty_loss":"1", 					"den_qty_scrap":"1", 					"fix_loss":"1", 					"fix_loss_scrap":"1", 					"id":"1", 					"is_cust_supitem":true, 					"issue_pattern":"D", 					"material_note":"2050332", 					"num_qty_scrap":"1", 					"station":"2050332", 					"sub_aux1_id":"10", 					"sub_aux2_id":"20", 					"sub_aux3_id":"30", 					"sub_aux4_id":"30", 					"sub_aux5_id":"30", 					"sub_aux_prop_id":"100", 					"sub_aux_qty":"1", 					"sub_aux_unit_id":"2050332", 					"sub_material_id":"788334223164455936", 					"sub_pro_license":"2050332", 					"sub_pro_place":"广东", 					"sub_pro_reg_no":"2050332", 					"sub_qty":2050332, 					"sub_sp_id":"2050332", 					"sub_stock_id":"2050332", 					"sub_supp_material_id":"1", 					"sub_unit_id":"2050332" 				} 			], 			"supp_material_id":"20202002", 			"tax_amount":1, 			"tax_price":1111, 			"unit_id":"1" 		} 	], 	"mulbill_label":[ 		{ 			"id":"23132312", 			"name":"名称信息", 			"number":"编码信息" 		} 	], 	"operation_key":"audit", 	"payment_entry":[ 		{ 			"paid_amount":213421421, 			"pay_comment":"这是备注", 			"pay_type_id":"213", 			"settle_account_id":"213" 		} 	], 	"remark":"备注", 	"settle_supplier_id":"11212166", 	"supplier_id":"供应商A", 	"trans_type_id":"1501" }'
```

### 响应参数

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| errcode | integer | 返回码，成功时为0 |
| description | string | 返回信息，成功时为success，失败时为具体信息 |
| data | Data | 业务返回具体对象 |

**Data**

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| id\_number\_map | Map <string> | id与编码map |
| ids | List <string> | 单据id数组对象 |

#### 响应示例

```json
{
  "data": {
    "id_number_map": {},
    "ids": [
      "1"
    ]
  },
  "description": "success",
  "errcode": 0
}
```

#### 返回码

| 返回码 | 描述 | 解决方案 |
| --- | --- | --- |
| [公告返回码](https://open.jdy.com/#/files/api/detail?index=2&categrayId=1f51c576013945e2af68ef15d4245a48&id=525e704824d24b178ab466530456c037) | 公告返回码 |  |
| 2000002000 | 系统错误,请到开发者社区提单反馈 | [开发者社区](https://vip.kingdee.com/developer?productLineId=29) |
