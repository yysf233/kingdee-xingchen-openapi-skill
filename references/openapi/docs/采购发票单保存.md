---
id: "kdcloud-79479f4960ec11efb84d4159a1165808"
title: "采购发票单保存"
source: "金蝶云社区"
url: "https://open.jdy.com/#/files/api/detail?index=3&categrayId=&id=79479f4960ec11efb84d4159a1165808"
author: ""
published_at: ""
product: "金蝶云苍穹"
module: ["进销存云", "采购单据", "采购发票"]
language: "Kingscript"
version_hint: ["V2"]
keywords: []
quality: "B"
---

# 采购发票单保存

### 基本信息

-   用途说明：采购发票单保存。审核、删除等详见[通用操作接口](https://open.jdy.com/#/files/api/detail?index=2&categrayId=3cc8ee9a663e11eda5c84b5d383a2b93&id=9e804b8c712511eda0b39f724d124b07)
-   请求方式：POST
-   请求地址：https://api.kingdee.com/jdy/v2/scm/pur\_invoice

### 请求参数

#### headers参数

| 参数名称 | 参数示例 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| Content-Type | application/json | true | 固定传：application/json |
| X-Api-ClientID | 205022 | true | 应用id，[创建指引](https://open.jdy.com/#/files/api/detail?index=3&categrayId=316e1f5bd9d711ed8e36c17691e84ff5&id=a540e3dcd9d811ed8e3677dc79b66e86&noside=true) |
| X-Api-Auth-Version | 2.0 | true | 固定传:2.0 |
| X-Api-TimeStamp | 1655775240000 | true | 当前时间毫秒时间戳，有效期为5min |
| X-Api-SignHeaders | X-Api-TimeStamp,X-Api-Nonce | true | 固定传：X-Api-TimeStamp,X-Api-Nonce |
| X-Api-Nonce | 1655775240000 | true | 随机正整数 |
| X-Api-Signature | xxx | true | [参考加密规则](https://open.jdy.com/#/files/api/detail?index=3&categrayId=5403e0fd6a5811eda819b759130d6d33&id=b5c26557da9d11ed8e36f9799578d2e1&noside=true) |
| app-token | xxx | true | 产品账套级别的token，[获取指引](https://open.jdy.com/#/files/api/detail?index=3&categrayId=5403e0fd6a5811eda819b759130d6d33&id=9076d1a6da9d11ed8e36874bed64e0be&noside=true) |
| X-GW-Router-Addr | https://tf.jdy.com | true | IDC域名，获取appKey返回消息体内的domain字段 |

#### body参数

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| material\_entity | List <MaterialEntity> | true | 商品分录 |
| supplier\_id | string | true | 供应商 |
| bill\_date | string | false | 单据日期 |
| bill\_no | string | false | 单据编码 |
| bill\_trans\_type | string | false | 单据业务类型，0：入库，1：退货；默认为0 |
| contact\_address | string | false | 结算供应商详细地址 |
| contact\_city\_id | string | false | 城市 |
| contact\_country\_id | string | false | 联系国家 |
| contact\_district\_id | string | false | 区域 |
| contact\_linkman | string | false | 联系信息-联系人 |
| contact\_phone | string | false | 结算供应商联系电话 |
| contact\_province\_id | string | false | 省份 |
| currency\_id | string | false | 币别id |
| custom\_field | Map <string> | false | 自定义字段[使用指南](https://open.jdy.com/#/files/api/detail?id=76567ff2a06311edaa4b3d71bf0fce53&noside=true) |
| deduction\_balance | string | false | 抵扣预付款 |
| deduction\_entry | List <DeductionEntry> | false | 抵扣预付款分录体 |
| dept\_id | string | false | 部门 |
| diff\_amount | number | false | 付款抹零 |
| emp\_id | string | false | 业务员 |
| exchange\_rate | string | false | 汇率 |
| id | string | false | 单据ID，修改单据时必填，新增不传该字段 |
| ivc\_type | string | false | 发票类型，1：普票，2：专票；默认为2 |
| operation\_key | string | false | 操作类型，固定取值：special\_save，执行特殊保存是必填 |
| out\_side\_pk\_id | string | false | 外部单号，如果第三方不使用星辰的ID，可以确保该单号唯一的情况下，新增与更新带上它 |
| remark | string | false | 备注 |
| reverse\_condition\_calculate | string | false | 是否从反算单价（保存修改应保持一致传参），true:反算，默认false |
| settle\_supplier\_id | string | false | 结算供应商 |

**DeductionEntry**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| arap\_cur\_settle\_amount | string | true | 本次核销金额 |
| arap\_src\_bill\_type\_id | string | true | 单据类型；预付款单：ap\_prepaybill，客户应付初始单据：ap\_initbasebill |
| arap\_src\_inter\_id | string | true | 源单（预付款单or客户应付初始单据）单据id |
| id | string | false | 修改时必传 |

**MaterialEntity**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| material\_id | string | true | 商品 |
| price | number | true | 价格 |
| qty | number | true | 数量 |
| unit\_id | string | true | 单位 |
| all\_amount | number | false | 价税合计 |
| all\_amount\_for | string | false | 价税合计本位币 |
| amount | number | false | 折后金额 |
| aux\_prop\_id | string | false | 辅助属性(辅助属性商品必填) |
| barcode | string | false | 条形码) |
| batch\_no | string | false | 批次号 (批次商品必填) |
| cess | number | false | 税率 |
| comment | string | false | 备注 |
| custom\_entity\_field | Map <string> | false | 自定义字段[使用指南](https://open.jdy.com/#/files/api/detail?id=76567ff2a06311edaa4b3d71bf0fce53&noside=true) |
| dis\_amount | number | false | 折扣额 |
| dis\_count | number | false | 折扣 |
| dis\_price | number | false | 折后单价 |
| id | string | false | 商品分录id，新增不传该字段，修改必传 |
| is\_free | boolean | false | 是否赠品 |
| kf\_date | string | false | 生产日期 |
| kf\_period | string | false | 保质期 |
| kf\_type | string | false | 保质期类型，1：天，2：月，3：年 |
| sp\_id | string | false | 仓位 |
| src\_bill\_type\_id | string | false | 源单类型：采购订单-pur\_bill\_order，采购入库单-pur\_bill\_inbound（源单信息传递时必填） |
| src\_entry\_id | string | false | 源单分录id（源单信息传递时必填） |
| src\_inter\_id | string | false | 源单id（源单信息传递时必填） |
| src\_seq | string | false | 源单行号（源单信息传递时必填） |
| stock\_id | string | false | 仓库 |
| tax\_amount | number | false | 税额 |
| tax\_price | number | false | 含税单价 |
| valid\_date | string | false | 到期日 |

#### 请求示例

```bash
curl --location --request  post 'https://api.kingdee.com/jdy/v2/scm/pur_invoice' \
--header 'Content-Type: application/json' \
--header 'X-Api-ClientID: 205022' \
--header 'X-Api-Auth-Version: 2.0' \
--header 'X-Api-TimeStamp: 1655775240000' \
--header 'X-Api-Nonce: 1655775240000' \
--header 'X-Api-SignHeaders: X-Api-TimeStamp,X-Api-Nonce' \
--header 'X-Api-Signature: xxx' \
--header 'app-token: xxx' \
--header 'X-GW-Router-Addr: https://tf.jdy.com' \
--data-row ' { 	"bill_date":"2024-08-01", 	"bill_no":"122212", 	"bill_trans_type":"1", 	"contact_address":"122212", 	"contact_city_id":"122212", 	"contact_country_id":"122212", 	"contact_district_id":"122212", 	"contact_linkman":"联系人A", 	"contact_phone":"122212", 	"contact_province_id":"122212", 	"currency_id":"1", 	"custom_field":{}, 	"deduction_balance":"122212", 	"deduction_entry":[ 		{ 			"arap_cur_settle_amount":"122212", 			"arap_src_bill_type_id":"122212", 			"arap_src_inter_id":"122212", 			"id":"122212" 		} 	], 	"dept_id":"122212", 	"diff_amount":122212, 	"emp_id":"122212", 	"exchange_rate":"10.3", 	"id":"122212", 	"ivc_type":"1", 	"material_entity":[ 		{ 			"all_amount":100, 			"all_amount_for":"21", 			"amount":20, 			"aux_prop_id":"1", 			"barcode":"202001", 			"batch_no":"202001", 			"cess":12, 			"comment":"备注行", 			"custom_entity_field":{}, 			"dis_amount":20, 			"dis_count":2, 			"dis_price":20, 			"id":"1", 			"is_free":true, 			"kf_date":"2024-02-12", 			"kf_period":"12", 			"kf_type":"13", 			"material_id":"753454885214650368", 			"price":12, 			"qty":1, 			"sp_id":"1", 			"src_bill_type_id":"pur_bill_inbound", 			"src_entry_id":"1", 			"src_inter_id":"1", 			"src_seq":"12", 			"stock_id":"1", 			"tax_amount":22.2, 			"tax_price":13, 			"unit_id":"3", 			"valid_date":"2024-02-12" 		} 	], 	"operation_key":"122212", 	"out_side_pk_id":"122212", 	"remark":"122212", 	"reverse_condition_calculate":"122212", 	"settle_supplier_id":"122212", 	"supplier_id":"122212" }'
```

### 响应参数

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| errcode | integer | 返回码，成功时为0 |
| description | string | 返回信息，成功时为success，失败时为具体信息 |
| data | Data | 业务返回具体对象 |

**Data**

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| id\_number\_map | Map <string> | id与编码map |
| ids | List <string> | 单据id数组对象 |

#### 响应示例

```json
{
  "data": {
    "id_number_map": {},
    "ids": [
      "1"
    ]
  },
  "description": "success",
  "errcode": 0
}
```

#### 返回码

| 返回码 | 描述 | 解决方案 |
| --- | --- | --- |
| [公告返回码](https://open.jdy.com/#/files/api/detail?index=2&categrayId=1f51c576013945e2af68ef15d4245a48&id=525e704824d24b178ab466530456c037) | 公告返回码 |  |
| 2000002000 | 系统错误,请到开发者社区提单反馈 | [开发者社区](https://vip.kingdee.com/developer?productLineId=29) |
