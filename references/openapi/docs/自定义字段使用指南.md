---
id: "kdcloud-76567ff2a06311edaa4b3d71bf0fce53"
title: "自定义字段使用指南"
source: "金蝶云社区"
url: "https://open.jdy.com/#/files/api/detail?index=3&categrayId=&id=76567ff2a06311edaa4b3d71bf0fce53"
author: ""
published_at: ""
product: "金蝶云苍穹"
module: ["系统设置"]
language: "Kingscript"
version_hint: ["V2", "V7"]
keywords: []
quality: "B"
---

# 自定义字段使用指南

### 功能简介

本文主要介绍如何通过API使用金蝶云星辰自定义字段的接口能力。

### 前置条件

-   [开发指南](https://open.jdy.com/#/files/api/detail?id=adfe4a24712711eda0b307c6992ee459&noside=true)

### 操作方式

#### Step 1：设置自定义字段

-   进入金蝶云星辰产品，在系统设置-个性化设置中，点击【基础资料新增字段】或【单据新增字段】
    操作手册详见：[单据及基础资料自定义字段](https://vip.kingdee.com/school/6587?productLineId=35&isKnowledge=2)

#### Step 2：获取自定义字段的接口信息

-   通过 [自定义字段查询（支持多表体）](https://open.jdy.com/#/files/api/detail?index=3&categrayId=3cc8ee9a663e11eda5c84b5d383a2b93&id=edd2aa3bb37011efadbd8be5add4e68e) 查询基础资料或单据的自定义字段接口信息，获取自定义字段编码（number）。

```json
{
  "data": {
    "rows": [
      {
        "number": "custom_field__2__4kw79ho2t0he",
        "display_name": "数值",
        "field_type": "2",
        "must_input": false,
        "def_value": "0",
        "precision": 4,
        "base_entity_number": "",
        "ref_field_number": "",
        "ref_field_type": "",
        "type_id": "",
        "formula": null,
        "custom_type": "head",
        "items": [],
        "audit_lock": true
      },
      {
        "number": "custom_entity_field__4__3yr9k90yr6fx",
        "display_name": "包装规格",
        "field_type": "4",
        "must_input": false,
        "def_value": "",
        "precision": 0,
        "base_entity_number": "bd_auxinfo",
        "ref_field_number": "",
        "ref_field_type": "",
        "type_id": "1894896201749267456",
        "formula": null,
        "custom_type": "material_entity",
        "items": [],
        "audit_lock": true
      },
      {
        "number": "custom_entity_field__6__4kw85ncc9boi",
        "display_name": "计量单位",
        "field_type": "6",
        "must_input": false,
        "def_value": "",
        "precision": 0,
        "base_entity_number": "bd_material",
        "ref_field_number": "baseunitid",
        "ref_field_type": "1",
        "type_id": "",
        "formula": null,
        "custom_type": "material_entity",
        "items": [],
        "audit_lock": false
      }
    ]
  },
  "description": "success",
  "errcode": 0
}
```

#### Step 3：提交自定义字段参数

-   以销售订单为例，假设销售订单表头新增自定义字段的number为【custom\_field\_\_2\_\_4kw79ho2t0he】，表体新增自定义字段的number为【custom\_entity\_field\_\_4\_\_3yr9k90yr6fx】
-   【销售订单详情】接口示例如下

```txt
"errcode":0, 	"data":{ 		"bill_date":"2022-02-02", 		"bill_no":"001", 		"create_time":"2020-03-02 15:15:59", 		"custom_field": {             			"custom_field__2__4kw79ho2t0he": "自定义字段具体值" 				}, 		"material_entity":[ 			{ 				"material_number":"1", 				"material_id":"697140092908614656", 				"comment":"xxxxx", 				"custom_entity_field": {             						"custom_entity_field__4__3yr9k90yr6fx": "自定义字段具体值" 							} 			} 		] 	}, 	"description":"success" }
```

-   【销售订单保存】接口示例如下

```bash
curl --location --request  post 'https://api.kingdee.com/jdy/v2/scm/sal_order' \
--header 'Content-Type: application/json' \
--header 'X-Api-ClientID: 205022' \
--header 'X-Api-Auth-Version: 2.0' \
--header 'X-Api-TimeStamp: 1655775240000' \
--header 'X-Api-Nonce: 1655775240000' \
--header 'X-Api-SignHeaders: X-Api-TimeStamp,X-Api-Nonce' \
--header 'X-Api-Signature: xxx' \
--header 'app-token: xxx' \
--header 'X-GW-Router-Addr: https://tf.jdy.com' \
--data-row ' { 	"data":{ 		"bill_date":"2022-02-02", 		"bill_no":"001", 		"create_time":"2020-03-02 15:15:59", 		"custom_field": {             			"custom_field__2__4kw79ho2t0he": "自定义字段具体值" 				}, 		"material_entity":[ 			{ 				"material_number":"1", 				"material_id":"697140092908614656", 				"comment":"xxxxx", 				"custom_entity_field": {             						"custom_entity_field__4__3yr9k90yr6fx": "自定义字段具体值" 							} 			} 		] 	} }'
```

### 特殊说明

-   **自定义字段为引用辅助资料、引用基础资料时，提交单据保存接口，自定义字段名需要增加【\_id】后缀，自定义字段值为：对应辅助资料或基础资料的id**
-   例如，销售订单表头增加自定义字段编码为custom\_entity\_field\_\_6\_\_4kw85ncc9boi，引用的是【基础资料-商品的基本单位】，保存销售接口时自定义字段名为custom\_entity\_field\_\_6\_\_4kw85ncc9boi\_id，保存销售接口时自定义字段的接口值为对应【基础资料-商品的基本单位】的id，基本单位id可以通过商品详情接口获取，请求示例如下：
    ![image.png](https://v7-oss.oss-cn-hangzhou.aliyuncs.com/jdyattachmentimage/10001/picture/banner/80a34864-3b67-11f0-975a-93c1781842f3.png?Expires=1772553604&OSSAccessKeyId=LTAIS4GEFAHOaSdj&Signature=%2BMlDoBF0jceoOfjRbj46Uac9PwE%3D)
