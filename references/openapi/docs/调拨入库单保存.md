---
id: "kdcloud-9e06fc9b712511eda0b34db29dc2e0a0"
title: "调拨入库单保存"
source: "金蝶云社区"
url: "https://open.jdy.com/#/files/api/detail?index=3&categrayId=&id=9e06fc9b712511eda0b34db29dc2e0a0"
author: ""
published_at: ""
product: "金蝶云苍穹"
module: ["进销存云", "仓存单据", "调拨入库"]
language: "Kingscript"
version_hint: ["V2"]
keywords: []
quality: "B"
---

# 调拨入库单保存

### 基本信息

-   用途说明：调拨入库单新增及修改。审核、删除等详见[通用操作接口](https://open.jdy.com/#/files/api/detail?index=2&categrayId=3cc8ee9a663e11eda5c84b5d383a2b93&id=9e804b8c712511eda0b39f724d124b07)
-   请求方式：POST
-   请求地址：https://api.kingdee.com/jdy/v2/scm/inv\_tfin

### 请求参数

#### headers参数

| 参数名称 | 参数示例 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| Content-Type | application/json | true | 固定传：application/json |
| X-Api-ClientID | 205022 | true | 应用id，[创建指引](https://open.jdy.com/#/files/api/detail?index=3&categrayId=316e1f5bd9d711ed8e36c17691e84ff5&id=a540e3dcd9d811ed8e3677dc79b66e86&noside=true) |
| X-Api-Auth-Version | 2.0 | true | 固定传:2.0 |
| X-Api-TimeStamp | 1655775240000 | true | 当前时间毫秒时间戳，有效期为5min |
| X-Api-SignHeaders | X-Api-TimeStamp,X-Api-Nonce | true | 固定传：X-Api-TimeStamp,X-Api-Nonce |
| X-Api-Nonce | 1655775240000 | true | 随机正整数 |
| X-Api-Signature | xxx | true | [参考加密规则](https://open.jdy.com/#/files/api/detail?index=3&categrayId=5403e0fd6a5811eda819b759130d6d33&id=b5c26557da9d11ed8e36f9799578d2e1&noside=true) |
| app-token | xxx | true | 产品账套级别的token，[获取指引](https://open.jdy.com/#/files/api/detail?index=3&categrayId=5403e0fd6a5811eda819b759130d6d33&id=9076d1a6da9d11ed8e36874bed64e0be&noside=true) |
| X-GW-Router-Addr | https://tf.jdy.com | true | IDC域名，获取appKey返回消息体内的domain字段 |

#### body参数

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| bill\_date | string | true | 出库日期,格式：2019-01-01 |
| material\_entity | List <MaterialEntity> | true | 商品分录 |
| allocate\_rule | string | false | 费用分摊规则；1: 按价税合计分摊（默认）； 2:按数量分摊 |
| bill\_no | string | false | 单据编码 |
| cost\_fee | string | false | 调拨费用 |
| cost\_fee\_entity | CostFeeEntity | false | 异价调拨的费用明细(当为异价调拨时) |
| custom\_field | Map <string> | false | 自定义字段[使用指南](https://open.jdy.com/#/files/api/detail?id=76567ff2a06311edaa4b3d71bf0fce53&noside=true) |
| dept\_id | string | false | 调入部门 |
| id | string | false | 新增不填，更新时必填（id为空时代表新增单据） |
| operation\_key | string | false | 操作类型，审核audit、提交submit |
| out\_dept\_id | string | false | 调出部门 |
| remark | string | false | 单据备注 |
| trans\_fer\_status | string | false | 调拨状态，0：未出库（默认），1：未入库，2：部分入库，3：全部入库 |
| trans\_type | string | false | 业务类型，1：同价调拨（默认），2：异价调拨 |

**CostFeeEntity**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| del\_ids | string | false | 需要删除的调拨费用分录ID，多个用英文逗号隔开；已经生成了其他应付单的费用不能删除，前端需要控制 |
| fee\_records | List <FeeRecords> | false | 费用记录 |

**FeeRecords**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| all\_amount | string | true | 价税合计 |
| all\_amount\_for | string | true | 价税合计本位币 |
| amount | string | true | 费用 |
| amount\_for | string | true | 费用本位币 |
| pacct\_type\_id | string | true | 支出类型 |
| settle\_supplier\_id | string | true | 结算供应商id |
| supplier\_id | string | true | 供应商id |
| comment | string | false | 备注 |
| currency\_id | string | false | 币别id |
| exchange\_rate | string | false | 汇率 |
| id | string | false | id |
| linked\_bill\_no | string | false | 生成的其他应付单号 |
| pay\_bill\_rule | boolean | false | 是否待支出 |
| tax\_amount | string | false | 税额 |

**MaterialEntity**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| in\_stock\_id | string | true | 调入仓库 |
| material\_id | string | true | 商品 |
| out\_stock\_id | string | true | 调出仓库 |
| qty | number | true | 数量 |
| unit\_id | string | true | 单位 |
| aux\_prop\_id | string | false | 辅助属性(辅助属性商品必填) |
| aux\_qty | number | false | 辅助数量（多单位商品，需要使用辅助单位时必填） |
| aux\_unit\_id | string | false | 辅助单位（多单位商品，需要使用辅助单位时必填） |
| batch\_no | string | false | 批次号（批次商品必填） |
| comment | string | false | 商品行备注 |
| cost\_share\_percent | number | false | 调入费用分摊比例，有费用分摊时必填且所有分录合计为100 |
| custom\_entity\_field | Map <string> | false | 自定义字段[使用指南](https://open.jdy.com/#/files/api/detail?id=76567ff2a06311edaa4b3d71bf0fce53&noside=true) |
| discount | number | false | 折扣（折），异价调拨必填 |
| fee | number | false | 调入费用分摊 |
| id | string | false | 分录id，新增不传该字段，修改必传 |
| in\_price | number | false | 异价调拨时必填，调拨入库单价 |
| in\_sp\_id | string | false | 调入仓位，启用了仓位管理则必填 |
| kf\_date | string | false | 生产日期（保质期商品必填，示例：2022-01-12） |
| kf\_period | integer | false | 保质期天数（保质期商品必填） |
| kf\_type | integer | false | 保质期类型：1/天，2/月，3/年（保质期商品必填） |
| out\_sp\_id | string | false | 调出仓位，启用了仓位管理则必填 |
| pro\_license | string | false | 注册许可证号 |
| pro\_place | string | false | 产地 |
| pro\_reg\_no | string | false | 生产许可证号 |
| sn\_list | string | false | 序列号 格式：001:备注1（序列号:序列号备注 多个序列号以英文分号字符分隔）,序列号商品必填 |
| src\_bill\_type\_id | string | false | 源单：调拨出库单inv\_tfout\_bill\_outbound |
| src\_entry\_id | string | false | 源单分录id |
| src\_inter\_id | string | false | 源单id |
| valid\_date | string | false | 有效日期 |

#### 请求示例

```bash
curl --location --request  post 'https://api.kingdee.com/jdy/v2/scm/inv_tfin' \
--header 'Content-Type: application/json' \
--header 'X-Api-ClientID: 205022' \
--header 'X-Api-Auth-Version: 2.0' \
--header 'X-Api-TimeStamp: 1655775240000' \
--header 'X-Api-Nonce: 1655775240000' \
--header 'X-Api-SignHeaders: X-Api-TimeStamp,X-Api-Nonce' \
--header 'X-Api-Signature: xxx' \
--header 'app-token: xxx' \
--header 'X-GW-Router-Addr: https://tf.jdy.com' \
--data-row ' { 	"allocate_rule":"1", 	"bill_date":"2019-01-01", 	"bill_no":"001", 	"cost_fee":"1", 	"cost_fee_entity":{ 		"del_ids":"1", 		"fee_records":[ 			{ 				"all_amount":"120.0", 				"all_amount_for":"120.0", 				"amount":"100.0", 				"amount_for":"321", 				"comment":"120.0", 				"currency_id":"备注1", 				"exchange_rate":"false", 				"id":"1", 				"linked_bill_no":"1", 				"pacct_type_id":"1", 				"pay_bill_rule":1, 				"settle_supplier_id":"1", 				"supplier_id":"1", 				"tax_amount":"20.0" 			} 		] 	}, 	"custom_field":{}, 	"dept_id":"767822134700457984", 	"id":"1", 	"material_entity":[ 		{ 			"aux_prop_id":"1", 			"aux_qty":50, 			"aux_unit_id":"50", 			"batch_no":"205022", 			"comment":"备注商品A", 			"cost_share_percent":100, 			"custom_entity_field":{}, 			"discount":10, 			"fee":100, 			"id":"1", 			"in_price":50, 			"in_sp_id":"1", 			"in_stock_id":"742589086056905728", 			"kf_date":"2022-08-08", 			"kf_period":180, 			"kf_type":180, 			"material_id":"768111411250384896", 			"out_sp_id":"2", 			"out_stock_id":"739166249459664896", 			"pro_license":"11111", 			"pro_place":"新疆", 			"pro_reg_no":"22222", 			"qty":50, 			"sn_list":"001", 			"src_bill_type_id":"inv_tfout_bill_outbound", 			"src_entry_id":"1", 			"src_inter_id":"1", 			"unit_id":"1", 			"valid_date":"2099-09-09" 		} 	], 	"operation_key":"audit", 	"out_dept_id":"0", 	"remark":"test", 	"trans_fer_status":"1", 	"trans_type":"1" }'
```

### 响应参数

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| errcode | integer | 返回码，成功时为0 |
| description | string | 返回信息，成功时为success，失败时为具体信息 |
| data | Data | 业务返回具体对象 |

**Data**

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| id\_number\_map | Map <string> | id与编码map |
| ids | List <string> | 单据id数组对象 |

#### 响应示例

```json
{
  "data": {
    "id_number_map": {},
    "ids": [
      "1"
    ]
  },
  "description": "success",
  "errcode": 0
}
```

#### 返回码

| 返回码 | 描述 | 解决方案 |
| --- | --- | --- |
| [公告返回码](https://open.jdy.com/#/files/api/detail?index=2&categrayId=1f51c576013945e2af68ef15d4245a48&id=525e704824d24b178ab466530456c037) | 公告返回码 |  |
| 2000002000 | 系统错误,请到开发者社区提单反馈 | [开发者社区](https://vip.kingdee.com/developer?productLineId=29) |
