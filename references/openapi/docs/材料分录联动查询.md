---
id: "kdcloud-78535c9fb08211eeaee31bf4436932c6"
title: "材料分录联动查询"
source: "金蝶云社区"
url: "https://open.jdy.com/#/files/api/detail?index=3&categrayId=&id=78535c9fb08211eeaee31bf4436932c6"
author: ""
published_at: ""
product: "金蝶云苍穹"
module: ["生产云", "生产管理", "生产任务单"]
language: "Kingscript"
version_hint: ["V2"]
keywords: []
quality: "B"
---

# 材料分录联动查询

### 基本信息

-   用途说明：材料分录联动查询
-   请求方式：POST
-   请求地址：https://api.kingdee.com/jdy/v2/pm/bom\_material

### 请求参数

#### headers参数

| 参数名称 | 参数示例 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| Content-Type | application/json | true | 固定传：application/json |
| X-Api-ClientID | 205022 | true | 应用id，[创建指引](https://open.jdy.com/#/files/api/detail?index=3&categrayId=316e1f5bd9d711ed8e36c17691e84ff5&id=a540e3dcd9d811ed8e3677dc79b66e86&noside=true) |
| X-Api-Auth-Version | 2.0 | true | 固定传:2.0 |
| X-Api-TimeStamp | 1655775240000 | true | 当前时间毫秒时间戳，有效期为5min |
| X-Api-SignHeaders | X-Api-TimeStamp,X-Api-Nonce | true | 固定传：X-Api-TimeStamp,X-Api-Nonce |
| X-Api-Nonce | 1655775240000 | true | 随机正整数 |
| X-Api-Signature | xxx | true | [参考加密规则](https://open.jdy.com/#/files/api/detail?index=3&categrayId=5403e0fd6a5811eda819b759130d6d33&id=b5c26557da9d11ed8e36f9799578d2e1&noside=true) |
| app-token | xxx | true | 产品账套级别的token，[获取指引](https://open.jdy.com/#/files/api/detail?index=3&categrayId=5403e0fd6a5811eda819b759130d6d33&id=9076d1a6da9d11ed8e36874bed64e0be&noside=true) |
| X-GW-Router-Addr | https://tf.jdy.com | true | IDC域名，获取appKey返回消息体内的domain字段 |

#### body参数

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| bill\_type | string | true | 单据类型(mo\_task\_bill) |
| material\_entity | List <materialEntity> | true | 产品分录(值可以对应的任务单或加工单详情中的材料分录,如果是根据选中产品带出材料,多个产品.如果是材料联动,只填一个产品) |
| change\_field | string | false | 材料分录变动的字段名,会根据对应修改字段联动其他值,如sub\_qty,会自动根据计划投料数联动其他分子分母信息 |
| trans\_type\_id | string | false | 单据的业务类型id |

**materialEntity**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| material\_id | string | true | 商品编码id |
| plan\_commit\_date | string | true | 计划开工日期（格式：2019-01-01） |
| plan\_finish\_date | string | true | 计划完工日期（格式：2019-01-01） |
| qty | number | true | 数量 |
| unit\_id | string | true | 单位ID |
| aux\_id1 | string | false | 辅助属性分类对应的辅助属性1ID(辅助属性商品必填) |
| aux\_id2 | string | false | 辅助属性分类对应的辅助属性2ID(辅助属性商品必填) |
| aux\_id3 | string | false | 辅助属性分类对应的辅助属性3ID(辅助属性商品必填) |
| aux\_id4 | string | false | 辅助属性分类对应的辅助属性4ID(辅助属性商品必填) |
| aux\_id5 | string | false | 辅助属性分类对应的辅助属性5ID(辅助属性商品必填) |
| aux\_prop\_id | string | false | 辅助属性分录id(辅助属性商品必填) |
| aux\_qty | number | false | 辅助数量 |
| aux\_unit\_id | string | false | 辅助单位ID |
| batch\_no | string | false | 生产批次 |
| bom\_id | string | false | 如果没有值,且材料分录没有值,如果产品配置了BOM会自动带出 |
| comment | string | false | 商品行备注 |
| customer\_id | string | false | 客户ID |
| pro\_license | string | false | 生产许可证 |
| pro\_place | string | false | 产地 |
| pro\_reg\_no | string | false | 注册证号 |
| seq | string | false | 分录行号 |
| sp\_id | string | false | 仓位id |
| src\_bill\_no | string | false | 源单单号 |
| src\_bill\_type\_id | string | false | 源单类型：销售订单sal\_bill\_order |
| src\_entry\_id | string | false | 源单分录id |
| src\_inter\_id | string | false | 源单id |
| src\_seq | string | false | 源单行号 |
| stock\_id | string | false | 仓库id |
| sub\_material\_entity | List <subMaterialEntity> | false | 材料分录 |

**subMaterialEntity**

| 参数名称 | 参数类型 | 是否必填 | 参数说明 |
| --- | --- | --- | --- |
| issue\_pattern | string | ture | 发料方式D：直接领料 A：倒冲领料 B：不领料 |
| den\_qty\_scrap | string | true | 产品产量（分母） |
| num\_qty\_scrap | string | true | 材料用量（分子） |
| sub\_material\_id | string | true | 物料编码ID |
| sub\_qty | number | true | 计划投料数 |
| sub\_unit\_id | string | true | 单位(M)ID |
| bom\_user\_define1 | string | false | BOM行备注1 |
| bom\_user\_define2 | string | false | BOM行备注2 |
| bom\_user\_define3 | string | false | BOM行备注3 |
| def\_float\_qty\_loss | string | false | 默认浮动单位损耗数量 |
| fix\_loss | string | false | 固定损耗 |
| fix\_loss\_scrap | string | false | 损耗率（%） |
| material\_note | string | false | 物料行备注 |
| seq | string | false | 分录行号 |
| station | string | false | 工位 |
| sub\_aux1\_id | string | false | 辅助属性(M)1ID |
| sub\_aux2\_id | string | false | 辅助属性(M)2ID |
| sub\_aux3\_id | string | false | 辅助属性(M)3ID |
| sub\_aux4\_id | string | false | 辅助属性(M)4ID |
| sub\_aux5\_id | string | false | 辅助属性(M)5ID |
| sub\_aux\_prop\_id | string | false | 辅助属性(M)ID |
| sub\_aux\_qty | string | false | 辅助数量（M） |
| sub\_aux\_unit\_id | string | false | 辅助单位(M)ID |
| sub\_pro\_license | string | false | 生产许可证(M) |
| sub\_pro\_place | string | false | 产地(M) |
| sub\_pro\_reg\_no | string | false | 注册证号(M) |
| sub\_sp\_id | string | false | 仓位ID |
| sub\_stock\_id | string | false | 仓库ID |

#### 请求示例

```bash
curl --location --request  post 'https://api.kingdee.com/jdy/v2/pm/bom_material' \
--header 'Content-Type: application/json' \
--header 'X-Api-ClientID: 205022' \
--header 'X-Api-Auth-Version: 2.0' \
--header 'X-Api-TimeStamp: 1655775240000' \
--header 'X-Api-Nonce: 1655775240000' \
--header 'X-Api-SignHeaders: X-Api-TimeStamp,X-Api-Nonce' \
--header 'X-Api-Signature: xxx' \
--header 'app-token: xxx' \
--header 'X-GW-Router-Addr: https://tf.jdy.com' \
--data-row ' { 	"bill_type":"10", 	"change_field":"10", 	"material_entity":[ 		{ 			"aux_id1":"10", 			"aux_id2":"20", 			"aux_id3":"30", 			"aux_id4":"30", 			"aux_id5":"30", 			"aux_prop_id":"100", 			"aux_qty":11, 			"aux_unit_id":"1", 			"batch_no":"1", 			"bom_id":"1", 			"comment":"2050332", 			"customer_id":"1", 			"material_id":"7883342231644", 			"plan_commit_date":"1", 			"plan_finish_date":"1", 			"pro_license":"2050332", 			"pro_place":"广东", 			"pro_reg_no":"2050332", 			"qty":11, 			"seq":"001", 			"sp_id":null, 			"src_bill_no":"1", 			"src_bill_type_id":"1", 			"src_entry_id":"1", 			"src_inter_id":"10", 			"src_seq":"4", 			"stock_id":"788176130963169280", 			"sub_material_entity":[ 				{ 					"bom_user_define1":"1", 					"bom_user_define2":"1", 					"bom_user_define3":"1", 					"def_float_qty_loss":"1", 					"den_qty_scrap":"1", 					"fix_loss":"1", 					"fix_loss_scrap":"1", 					"issue_pattern":"D", 					"material_note":"2050332", 					"num_qty_scrap":"1", 					"seq":"1", 					"station":"2050332", 					"sub_aux1_id":"10", 					"sub_aux2_id":"20", 					"sub_aux3_id":"30", 					"sub_aux4_id":"30", 					"sub_aux5_id":"30", 					"sub_aux_prop_id":"100", 					"sub_aux_qty":"1", 					"sub_aux_unit_id":"2050332", 					"sub_material_id":"788334223164455936", 					"sub_pro_license":"2050332", 					"sub_pro_place":"广东", 					"sub_pro_reg_no":"2050332", 					"sub_qty":2050332, 					"sub_sp_id":"2050332", 					"sub_stock_id":"2050332", 					"sub_unit_id":"2050332" 				} 			], 			"unit_id":"1" 		} 	], 	"trans_type_id":"10" }'
```

### 响应参数

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| errcode | integer | 返回码，成功时为0 |
| description | string | 返回信息，成功时为success，失败时为具体信息 |
| data | Data | 业务返回具体对象 |

**Data**

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| rows | List <Row> |  |

**Row**

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| qty | number | 数量 |
| aux1\_name | string | 辅助属性1名称 |
| aux1\_number | string | 辅助属性1编码 |
| aux2\_id | string | 辅助属性2ID |
| aux2\_name | string | 辅助属性2名称 |
| aux2\_number | string | 辅助属性2编码 |
| aux3\_id | string | 辅助属性3ID |
| aux3\_name | string | 辅助属性3名称 |
| aux3\_number | string | 辅助属性3编码 |
| aux4\_id | string | 辅助属性4ID |
| aux4\_name | string | 辅助属性4名称 |
| aux4\_number | string | 辅助属性4编码 |
| aux5\_id | string | 辅助属性5ID |
| aux5\_name | string | 辅助属性5名称 |
| aux5\_number | string | 辅助属性5编码 |
| aux\_id1 | string | 辅助属性1ID |
| aux\_prop\_id | string | 辅助属性id |
| aux\_prop\_name | string | 辅助属性名称(辅助属性商品必填) |
| aux\_prop\_number | string | 辅助属性编码 |
| aux\_unit\_id | string | 单位ID |
| aux\_unit\_name | string | 辅助单位名称 |
| aux\_unit\_number | string | 辅助单位编码 |
| batch\_no | string | 生产批次 |
| bom\_id | string | BOM ID |
| bom\_number | string | BOM 编码 |
| comment | string | 商品行备注 |
| customer\_id | string | 客户ID |
| customer\_name | string | 客户名称 |
| customer\_number | string | 客户编码 |
| material\_id | string | 商品编码id |
| material\_name | string | 商品名称 |
| material\_number | string | 商品编码 |
| plan\_commit\_date | string | 计划开工日期（格式：2019-01-01） |
| plan\_finish\_date | string | 计划完工日期（格式：2019-01-01） |
| pro\_license | string | 生产许可证 |
| pro\_place | string | 产地 |
| pro\_reg\_no | string | 注册证号 |
| seq | string | 分录行号 |
| sp\_id | string | 仓位id |
| sp\_name | string | 仓位名称 |
| sp\_number | string | 仓位编码 |
| src\_bill\_no | string | 源单单号 |
| src\_bill\_type\_id | string | 源单类型：销售订单sal\_bill\_order |
| src\_entry\_id | string | 源单分录id |
| src\_inter\_id | string | 源单id |
| src\_seq | string | 源单行号 |
| stock\_id | string | 仓库id |
| stock\_name | string | 仓库名称 |
| stock\_number | string | 仓库编码 |
| sub\_material\_entity | List <subMaterialEntity> | 材料分录 |
| unit\_id | string | 单位ID |
| unit\_name | string | 单位名称 |
| unit\_number | string | 单位编码 |

**subMaterialEntity**

| 参数名称 | 参数类型 | 参数说明 |
| --- | --- | --- |
| issue\_pattern | string | 发料方式D：直接领料 A：倒冲领料 B：不领料 |
| sub\_qty | number | 计划投料数 |
| bom\_user\_define1 | string | BOM行备注1 |
| bom\_user\_define2 | string | BOM行备注2 |
| bom\_user\_define3 | string | BOM行备注3 |
| def\_float\_qty\_loss | string | 默认浮动单位损耗数量 |
| den\_qty\_scrap | string | 产品产量（分母） |
| fix\_loss | string | 固定损耗 |
| fix\_loss\_scrap | string | 损耗率（%） |
| material\_note | string | 物料行备注 |
| num\_qty\_scrap | string | 材料用量（分子） |
| seq | string | 分录行号 |
| station | string | 工位 |
| sub\_aux1\_id | string | 辅助属性(M)1ID |
| sub\_aux1\_name | string | 辅助属性(M)1名称 |
| sub\_aux1\_number | string | 辅助属性(M)1编码 |
| sub\_aux2\_id | string | 辅助属性(M)2ID |
| sub\_aux2\_name | string | 辅助属性(M)2名称 |
| sub\_aux2\_number | string | 辅助属性(M)2编码 |
| sub\_aux3\_id | string | 辅助属性(M)3ID |
| sub\_aux3\_name | string | 辅助属性(M)3名称 |
| sub\_aux3\_number | string | 辅助属性(M)3编码 |
| sub\_aux4\_id | string | 辅助属性(M)4ID |
| sub\_aux4\_name | string | 辅助属性(M)4名称 |
| sub\_aux4\_number | string | 辅助属性(M)4编码 |
| sub\_aux5\_id | string | 辅助属性(M)5ID |
| sub\_aux5\_name | string | 辅助属性(M)5名称 |
| sub\_aux5\_number | string | 辅助属性(M)5编码 |
| sub\_aux\_prop\_id | string | 物料编码ID |
| sub\_aux\_prop\_name | string | 物料编码名称 |
| sub\_aux\_prop\_number | string | 物料编码编码 |
| sub\_aux\_qty | string | 辅助数量（M） |
| sub\_aux\_unit\_id | string | 辅助单位(M)ID |
| sub\_aux\_unit\_name | string | 辅助单位(M)名称 |
| sub\_aux\_unit\_number | string | 辅助单位(M)编码 |
| sub\_material\_id | string | 物料编码ID |
| sub\_material\_name | string | 物料编码名称 |
| sub\_material\_number | string | 物料编码编码 |
| sub\_pro\_license | string | 生产许可证(M) |
| sub\_pro\_place | string | 产地(M) |
| sub\_pro\_reg\_no | string | 注册证号(M) |
| sub\_sp\_id | string | 仓位ID |
| sub\_sp\_name | string | 仓位名称 |
| sub\_sp\_number | string | 仓位编码 |
| sub\_stock\_id | string | 仓库ID |
| sub\_stock\_name | string | 仓库名称 |
| sub\_stock\_number | string | 仓库编码 |
| sub\_unit\_id | string | 单位(M)ID |
| sub\_unit\_name | string | 单位(M)名称 |
| sub\_unit\_number | string | 单位(M)编码 |

#### 响应示例

```json
{
  "data": {
    "rows": [
      {
        "aux1_name": "10",
        "aux1_number": "10",
        "aux2_id": "10",
        "aux2_name": "10",
        "aux2_number": "10",
        "aux3_id": "10",
        "aux3_name": "10",
        "aux3_number": "10",
        "aux4_id": "10",
        "aux4_name": "10",
        "aux4_number": "10",
        "aux5_id": "10",
        "aux5_name": "10",
        "aux5_number": "10",
        "aux_id1": "10",
        "aux_prop_id": "788334",
        "aux_prop_name": "111",
        "aux_prop_number": "7883342",
        "aux_unit_id": "1",
        "aux_unit_name": "1",
        "aux_unit_number": "1",
        "batch_no": "1",
        "bom_id": "1",
        "bom_number": "1",
        "comment": "2050332",
        "customer_id": "1",
        "customer_name": "1",
        "customer_number": "112",
        "material_id": "7883342231644",
        "material_name": "耳机",
        "material_number": "7883342",
        "plan_commit_date": "1",
        "plan_finish_date": "1",
        "pro_license": "2050332",
        "pro_place": "广东",
        "pro_reg_no": "2050332",
        "qty": 11,
        "seq": "001",
        "sp_id": null,
        "sp_name": null,
        "sp_number": null,
        "src_bill_no": "1",
        "src_bill_type_id": "1",
        "src_entry_id": "1",
        "src_inter_id": "10",
        "src_seq": "4",
        "stock_id": "788176130963169280",
        "stock_name": "280",
        "stock_number": "788176130",
        "sub_material_entity": [
          {
            "bom_user_define1": "1",
            "bom_user_define2": "1",
            "bom_user_define3": "1",
            "def_float_qty_loss": "1",
            "den_qty_scrap": "1",
            "fix_loss": "1",
            "fix_loss_scrap": "1",
            "issue_pattern": "D",
            "material_note": "2050332",
            "num_qty_scrap": "1",
            "seq": "1",
            "station": "2050332",
            "sub_aux1_id": "7883342231",
            "sub_aux1_name": "afa",
            "sub_aux1_number": "7883342231",
            "sub_aux2_id": "7883342231",
            "sub_aux2_name": "afa",
            "sub_aux2_number": "7883342231",
            "sub_aux3_id": "7883342231",
            "sub_aux3_name": "afa",
            "sub_aux3_number": "7883342231",
            "sub_aux4_id": "7883342231",
            "sub_aux4_name": "afa",
            "sub_aux4_number": "7883342231",
            "sub_aux5_id": "7883342231",
            "sub_aux5_name": "afa",
            "sub_aux5_number": "7883342231",
            "sub_aux_prop_id": "7883342231",
            "sub_aux_prop_name": "afa",
            "sub_aux_prop_number": "7883342231",
            "sub_aux_qty": "1",
            "sub_aux_unit_id": "2050332",
            "sub_aux_unit_name": "2050332",
            "sub_aux_unit_number": "2050332",
            "sub_material_id": "7883342231",
            "sub_material_name": "afa",
            "sub_material_number": "7883342231",
            "sub_pro_license": "2050332",
            "sub_pro_place": "广东",
            "sub_pro_reg_no": "2050332",
            "sub_qty": 2050332,
            "sub_sp_id": "2050332",
            "sub_sp_name": "2050332",
            "sub_sp_number": "2050332",
            "sub_stock_id": "2050332",
            "sub_stock_name": "halou",
            "sub_stock_number": "2050332",
            "sub_unit_id": "2050332",
            "sub_unit_name": "2050332",
            "sub_unit_number": "2050332"
          }
        ],
        "unit_id": "1",
        "unit_name": "1",
        "unit_number": "1"
      }
    ]
  },
  "description": "success",
  "errcode": 0
}
```

#### 返回码

| 返回码 | 描述 | 解决方案 |
| --- | --- | --- |
| [公告返回码](https://open.jdy.com/#/files/api/detail?index=2&categrayId=1f51c576013945e2af68ef15d4245a48&id=525e704824d24b178ab466530456c037) | 公告返回码 |  |
| 2000002000 | 系统错误,请到开发者社区提单反馈 | [开发者社区](https://vip.kingdee.com/developer?productLineId=29) |
